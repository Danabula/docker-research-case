---
title: Virtualizatie
order: 1
active: 1
goto:
 type: assignment
 index: 1
---

# Virtualizatie

Virtualizatie is het isoleren en naabootsen van hardware en software apis.  
Voorbeelden van virtualizatie zijn virtuele machines, containers, jails en virtual memory.  
Vaak wordt met virtualizatie bedoeld het draaien van een computer in een computer door de hardware na te bootsen,  
want andere virtualizatie methodes hebben eigen terminologie.

---

![Virtuale machines](Virtual-Machines-Header-2.jpg)
**TODO create better image, skewed xorg, windows login, windows desktop, xfce desktop, sway, genode, in corner of screen, do you recognize all running programs impressive, hyprland, alpine, waydroid & nested virtualization**
Zo'n collectie van virtuale hardware zoals een timer, een virtuele cpu en een virtueel scherm wordt een virtuele machine (vm) genoemd.  
Op die virtuele hardware kan je net zoals op een echte computer (bare metal) een operating systeem installeren.  
Dat operating systeem in de vm wordt een guest genoemd en de machine waarop de vm draaid wordt de host machine genoemd.  
Voorkomende variantan van virtualizatie zijn hardware virtualizatie, waarbij de hardware wordt nagebootsd door een hypervisor en operating systeem virtualizatie waarbij een operating systeem applicaties kan isoleren, zoals jails en kernel namespaces.

---

Het nabootsen van hardware is erg langzaam, dus er is hardware acceleratie voor virtualizatie ontwikkeld,  
namelijk specifieke cpu instructies waar hypervisors gebruik van kunnen maken.  
Voor hardware acceleratie op x86 cpus moet je vt-x voor intel cpus of amd-v cpu extenties aan zetten in de bios van je computer.  
Dit is alleen voor de cpu instructies, om je hardware te isoleren van virtuele machines heb je ook vt-d of amd-vi nodig.  
[hardware acceleratie](https://en.wikipedia.org/wiki/Intel_VT-d?lang=en#Hardware-assisted_virtualization).

---

Virtualizatie is ontstaan in *blah blah blah*.
Wordt gebruikt door websites en hosting voor isolatie en security.
**gebruik van virtualizatie & een beetje geschiedenis**


---

## Hypervisor

Die virtuele hardware creeen & het draaien van vms wordt gedaan door een hypervisor.  
Je hebt 2 soorten hypervisors:  
- type-1  
    Dit is een hypervisor die op de bare metal draait.
    Xen geeft 1 vm privilege geeft om met de hypervisor te communiceren, die vm met privileges wordt dom-0 genoemd
    voorbeelden van type-1 hypervisors zijn de [xen hypervisor](https://xenproject.org) en de [nova microhypervisor](https://github.com/udosteinberg/NOVA)
- type-2  


---


Software die gebruikt wordt om machines te gebruiken zijn [virtualbox](https://www.virtualbox.org/), [virt-manager](https://virt-manager.org/) en virsh.
virtualbox is een manager en hypervisor
**OVERVIEW VIRTUAL MACHINE TOOLING IMAGE**
virt-manager is een client voor libvirt die [qemu](https://www.qemu.org/) gebruikt


---

## Pros
- Isolatie van het host operating systeem.
    - Vms worden gebruikt voor malware analyse.


## Cons
- Het virtualizeren van een heel operating systeem is inefficient en kost veel resources.
- Hardware gpu acceleratie kan niet gedeeld worden zoals een cpu (multiplexen):
    - Als je 1 gpu hebt moet je kiezen of je die aan de host of aan de guest machine geeft.
- Het managen van vms zonder externe tooling kan wat moeizaam zijn
- Het opstarten en stoppen van een heel operating systeem is langzaam (minimaal 5 seconden) vergeleken met normale applicaties
- Een aantal applicaties werken niet door attestatie,
  waarbij de hardware wordt gecheckt of er geknoeit kan worden met de applicaties.  
  [Trusted computing](https://en.wikipedia.org/wiki/Trusted_Computing?lang=en)  
  Een virtuele machine haalt zo'n soort test niet.  
  Voorbeelden zijn drm (netflix videos) en android safetynet (apps voor bankieren),  
  deze applicaties kan je niet gemakkelijk in virtuele machines draaien  
